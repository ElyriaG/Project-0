<!DOCTYPE html>
<html>
<head>
  <title>Spotify Web Playback SDK Quick Start Tutorial</title>
</head>
<body>
  <h1>Spotify Web Playback SDK Quick Start Tutorial</h1>
  <h2>Open your console log: <code>View > Developer > JavaScript Console</code></h2>
  <iframe id="player" src="" width="300" height="380" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe>

  <script src="https://sdk.scdn.co/spotify-player.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script>
    window.onSpotifyWebPlaybackSDKReady = () => {
      const token = 'BQD8v7heZAMSlHAuZmvKaL9WDCUhm-vqS69051Xkz-F8x8HcrItSSUynGAp85at53MJr2kLNc19YHOdLELWCekflnxqk4oPn56oBelvrDdydB0hw5e4GkCFp2J0xfkD_4cfRLlMW-wr8dlf9CkVp46d1k1pIfvr3-OUJWHvK4fCtG1hh6YhlyGVL';
      const player = new Spotify.Player({
        name: 'Web Playback SDK Quick Start Player',
        getOAuthToken: cb => { cb(token); }
      });

      // Error handling
      player.addListener('initialization_error', ({ message }) => { console.error(message); });
      player.addListener('authentication_error', ({ message }) => { console.error(message); });
      player.addListener('account_error', ({ message }) => { console.error(message); });
      player.addListener('playback_error', ({ message }) => { console.error(message); });

      // Playback status updates
      player.addListener('player_state_changed', state => { console.log(state); });

      // Ready
      player.addListener('ready', ({ device_id }) => {
        console.log('Ready with Device ID', device_id);
      });

      // Not Ready
      player.addListener('not_ready', ({ device_id }) => {
        console.log('Device ID has gone offline', device_id);
      });

      // Connect to the player!
      player.connect();
    };

    var topic = "happy"

var queryURL = "https://api.spotify.com/v1/search?q=" + topic + "&type=playlist" 
  
      // We then created an AJAX call
      $.ajax({
      url: queryURL,
      method: "GET",
      headers: {"Accept": "application/json", "Content-Type": "application/json", "Authorization": "BQD0CR7GZmWI-97X-xrKgMWHy6q9r2tW0ohLB-prDY_DM8NOOIW50j_e4roy-pgVqdlBSSWABNb3WV48-2zhNAzFidoxC0GFyijL_zopHeEsDIQ00_aOZwQKXM1kMCDjtJmjytKiv0pHyExPW94e19Gy9Thp1anppQ"}
      }).then(function(response) {
      // console.log(response.playlists.items[0].external_urls.spotify)
      console.log(response)
      var id = response.playlists.items[8].id
      var urlBuilder = "https://open.spotify.com/embed/playlist/"
      var link = urlBuilder + id;
      console.log(link)
      $("#player").attr("src", link)
      
      
      });
  </script>
</body>
</html>